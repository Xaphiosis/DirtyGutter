/*
 * XSymbolSubst - String translator for Isabelle 2023 xsymbols.
 *
 * Copyright (C) 2024 Rafal Kolanski
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 */
package lcm;

import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.HashMap;
import java.util.Map;

public class XSymbolSubst {
    public static final Pattern xsymbolPat = Pattern.compile("\\\\<(\\^?\\w+)>");
    public static final Map<String,String> symbolMap = makeSymbolMap();

    private static Map<String,String> makeSymbolMap() {
        Map<String,String> map = new HashMap<String,String>(500);

        map.put("\\<a>", "ğ–º");
        map.put("\\<A>", "ğ’œ");
        map.put("\\<aa>", "ğ”");
        map.put("\\<AA>", "ğ”„");
        map.put("\\<^action>", "â˜›");
        map.put("\\<acute>", "Â´");
        map.put("\\<aleph>", "â„µ");
        map.put("\\<alpha>", "Î±");
        map.put("\\<amalg>", "â¨¿");
        map.put("\\<and>", "âˆ§");
        map.put("\\<And>", "â‹€");
        map.put("\\<angle>", "âˆ ");
        map.put("\\<approx>", "â‰ˆ");
        map.put("\\<asymp>", "â‰");
        map.put("\\<bar>", "Â¦");
        map.put("\\<b>", "ğ–»");
        map.put("\\<B>", "â„¬");
        map.put("\\<bbar>", "â«¿");
        map.put("\\<bb>", "ğ”Ÿ");
        map.put("\\<BB>", "ğ”…");
        map.put("\\<bbbA>", "ğ”¸");
        map.put("\\<bbbD>", "ğ”»");
        map.put("\\<bbbE>", "ğ”¼");
        map.put("\\<bbbF>", "ğ”½");
        map.put("\\<bbbG>", "ğ”¾");
        map.put("\\<bbbH>", "â„");
        map.put("\\<bbbI>", "ğ•€");
        map.put("\\<bbbJ>", "ğ•");
        map.put("\\<bbbK>", "ğ•‚");
        map.put("\\<bbbL>", "ğ•ƒ");
        map.put("\\<bbbM>", "ğ•„");
        map.put("\\<bbbO>", "ğ•†");
        map.put("\\<bbbP>", "â„™");
        map.put("\\<bbbS>", "ğ•Š");
        map.put("\\<bbbT>", "ğ•‹");
        map.put("\\<bbbU>", "ğ•Œ");
        map.put("\\<bbbV>", "ğ•");
        map.put("\\<bbbW>", "ğ•");
        map.put("\\<bbbX>", "ğ•");
        map.put("\\<bbbY>", "ğ•");
        map.put("\\<beta>", "Î²");
        map.put("\\<^bigskip>", "â”");
        map.put("\\<bind>", "â¤œ");
        map.put("\\<^bold>", "â™");
        map.put("\\<bool>", "ğ”¹");
        map.put("\\<bottom>", "âŠ¥");
        map.put("\\<bowtie>", "â¨");
        map.put("\\<box>", "â–¡");
        map.put("\\<^bsub>", "â‡˜");
        map.put("\\<^bsup>", "â‡—");
        map.put("\\<bullet>", "âˆ™");
        map.put("\\<^cancel>", "âŒ¦");
        map.put("\\<c>", "ğ–¼");
        map.put("\\<C>", "ğ’");
        map.put("\\<cc>", "ğ” ");
        map.put("\\<CC>", "â„­");
        map.put("\\<cdot>", "â‹…");
        map.put("\\<cdots>", "â‹¯");
        map.put("\\<cedilla>", "Â¸");
        map.put("\\<cent>", "Â¢");
        map.put("\\<checkmark>", "âœ“");
        map.put("\\<chi>", "Ï‡");
        map.put("\\<circ>", "âˆ˜");
        map.put("\\<circle>", "â—‹");
        map.put("\\<close>", "â€º");
        map.put("\\<clubsuit>", "â™£");
        map.put("\\<Colon>", "âˆ·");
        map.put("\\<comment>", "â€•");
        map.put("\\<complex>", "â„‚");
        map.put("\\<cong>", "â‰…");
        map.put("\\<Coprod>", "âˆ");
        map.put("\\<copyright>", "Â©");
        map.put("\\<crossmark>", "âœ—");
        map.put("\\<currency>", "Â¤");
        map.put("\\<dagger>", "â€ ");
        map.put("\\<d>", "ğ–½");
        map.put("\\<D>", "ğ’Ÿ");
        map.put("\\<ddagger>", "â€¡");
        map.put("\\<dd>", "ğ”¡");
        map.put("\\<DD>", "ğ”‡");
        map.put("\\<degree>", "Â°");
        map.put("\\<delta>", "Î´");
        map.put("\\<Delta>", "Î”");
        map.put("\\<^descr>", "â§");
        map.put("\\<diamond>", "â—‡");
        map.put("\\<diamondop>", "â‹„");
        map.put("\\<diamondsuit>", "â™¢");
        map.put("\\<dieresis>", "Â¨");
        map.put("\\<^dir>", "ğŸ—€");
        map.put("\\<div>", "Ã·");
        map.put("\\<^doc>", "ğŸ““");
        map.put("\\<doteq>", "â‰");
        map.put("\\<dots>", "â€¦");
        map.put("\\<down>", "â†“");
        map.put("\\<Down>", "â‡“");
        map.put("\\<downharpoonleft>", "â‡ƒ");
        map.put("\\<downharpoonright>", "â‡‚");
        map.put("\\<e>", "ğ–¾");
        map.put("\\<E>", "â„°");
        map.put("\\<ee>", "ğ”¢");
        map.put("\\<EE>", "ğ”ˆ");
        map.put("\\<eight>", "ğŸ´");
        map.put("\\<^emph>", "âˆ—");
        map.put("\\<emptyset>", "âˆ…");
        map.put("\\<^enum>", "â–¸");
        map.put("\\<epsilon>", "Îµ");
        map.put("\\<equiv>", "â‰¡");
        map.put("\\<^esub>", "â‡™");
        map.put("\\<^esup>", "â‡–");
        map.put("\\<eta>", "Î·");
        map.put("\\<euro>", "â‚¬");
        map.put("\\<exclamdown>", "Â¡");
        map.put("\\<exists>", "âˆƒ");
        map.put("\\<f>", "ğ–¿");
        map.put("\\<F>", "â„±");
        map.put("\\<ff>", "ğ”£");
        map.put("\\<FF>", "ğ”‰");
        map.put("\\<^file>", "ğŸ—");
        map.put("\\<five>", "ğŸ±");
        map.put("\\<flat>", "â™­");
        map.put("\\<^footnote>", "â‹");
        map.put("\\<forall>", "âˆ€");
        map.put("\\<four>", "ğŸ°");
        map.put("\\<frown>", "âŒ¢");
        map.put("\\<gamma>", "Î³");
        map.put("\\<Gamma>", "Î“");
        map.put("\\<ge>", "â‰¥");
        map.put("\\<g>", "ğ—€");
        map.put("\\<G>", "ğ’¢");
        map.put("\\<gg>", "ğ”¤");
        map.put("\\<GG>", "ğ”Š");
        map.put("\\<ggreater>", "â‰«");
        map.put("\\<greaterapprox>", "âª†");
        map.put("\\<greatersim>", "â‰³");
        map.put("\\<guillemotleft>", "Â«");
        map.put("\\<guillemotright>", "Â»");
        map.put("\\<heartsuit>", "â™¡");
        map.put("\\<^here>", "âŒ‚");
        map.put("\\<h>", "ğ—");
        map.put("\\<H>", "â„‹");
        map.put("\\<hh>", "ğ”¥");
        map.put("\\<HH>", "â„Œ");
        map.put("\\<hole>", "âŒ‘");
        map.put("\\<hookleftarrow>", "â†©");
        map.put("\\<hookrightarrow>", "â†ª");
        map.put("\\<hungarumlaut>", "Ë");
        map.put("\\<hyphen>", "Â­");
        map.put("\\<i>", "ğ—‚");
        map.put("\\<I>", "â„");
        map.put("\\<ii>", "ğ”¦");
        map.put("\\<II>", "â„‘");
        map.put("\\<in>", "âˆˆ");
        map.put("\\<index>", "Ä±");
        map.put("\\<infinity>", "âˆ");
        map.put("\\<integral>", "âˆ«");
        map.put("\\<inter>", "âˆ©");
        map.put("\\<Inter>", "â‹‚");
        map.put("\\<interleave>", "â«´");
        map.put("\\<int>", "â„¤");
        map.put("\\<inverse>", "Â¯");
        map.put("\\<iota>", "Î¹");
        map.put("\\<^item>", "â–ª");
        map.put("\\<j>", "ğ—ƒ");
        map.put("\\<J>", "ğ’¥");
        map.put("\\<jj>", "ğ”§");
        map.put("\\<JJ>", "ğ”");
        map.put("\\<Join>", "â‹ˆ");
        map.put("\\<kappa>", "Îº");
        map.put("\\<k>", "ğ—„");
        map.put("\\<K>", "ğ’¦");
        map.put("\\<kk>", "ğ”¨");
        map.put("\\<KK>", "ğ”");
        map.put("\\<lambda>", "Î»");
        map.put("\\<Lambda>", "Î›");
        map.put("\\<langle>", "âŸ¨");
        map.put("\\<lblot>", "â¦‰");
        map.put("\\<lbrace>", "â¦ƒ");
        map.put("\\<lbrakk>", "âŸ¦");
        map.put("\\<lceil>", "âŒˆ");
        map.put("\\<le>", "â‰¤");
        map.put("\\<leadsto>", "â†");
        map.put("\\<leftarrow>", "â†");
        map.put("\\<Leftarrow>", "â‡");
        map.put("\\<leftharpoondown>", "â†½");
        map.put("\\<leftharpoonup>", "â†¼");
        map.put("\\<leftrightarrow>", "â†”");
        map.put("\\<Leftrightarrow>", "â‡”");
        map.put("\\<lessapprox>", "âª…");
        map.put("\\<lesssim>", "â‰²");
        map.put("\\<lfloor>", "âŒŠ");
        map.put("\\<lhd>", "âŠ²");
        map.put("\\<l>", "ğ—…");
        map.put("\\<L>", "â„’");
        map.put("\\<llangle>", "âŸª");
        map.put("\\<Lleftarrow>", "â‡š");
        map.put("\\<lless>", "â‰ª");
        map.put("\\<ll>", "ğ”©");
        map.put("\\<LL>", "ğ”");
        map.put("\\<longleftarrow>", "âŸµ");
        map.put("\\<Longleftarrow>", "âŸ¸");
        map.put("\\<longleftrightarrow>", "âŸ·");
        map.put("\\<Longleftrightarrow>", "âŸº");
        map.put("\\<longlongleftarrow>", "â¤");
        map.put("\\<longlonglongleftarrow>", "â‡ ");
        map.put("\\<longlonglongrightarrow>", "â‡¢");
        map.put("\\<longlongrightarrow>", "â¤");
        map.put("\\<longmapsto>", "âŸ¼");
        map.put("\\<longrightarrow>", "âŸ¶");
        map.put("\\<Longrightarrow>", "âŸ¹");
        map.put("\\<lozenge>", "â—Š");
        map.put("\\<lparr>", "â¦‡");
        map.put("\\<mapsto>", "â†¦");
        map.put("\\<^marker>", "âœ");
        map.put("\\<^medskip>", "â”‰");
        map.put("\\<mho>", "â„§");
        map.put("\\<midarrow>", "â”€");
        map.put("\\<Midarrow>", "â•");
        map.put("\\<minusplus>", "âˆ“");
        map.put("\\<m>", "ğ—†");
        map.put("\\<M>", "â„³");
        map.put("\\<mm>", "ğ”ª");
        map.put("\\<MM>", "ğ”");
        map.put("\\<mu>", "Î¼");
        map.put("\\<nabla>", "âˆ‡");
        map.put("\\<nat>", "â„•");
        map.put("\\<natural>", "â™®");
        map.put("\\<newline>", "â");
        map.put("\\<nexists>", "âˆ„");
        map.put("\\<nine>", "ğŸµ");
        map.put("\\<n>", "ğ—‡");
        map.put("\\<N>", "ğ’©");
        map.put("\\<nn>", "ğ”«");
        map.put("\\<NN>", "ğ”‘");
        map.put("\\<^noindent>", "â‡¤");
        map.put("\\<not>", "Â¬");
        map.put("\\<noteq>", "â‰ ");
        map.put("\\<notin>", "âˆ‰");
        map.put("\\<nu>", "Î½");
        map.put("\\<odot>", "âŠ™");
        map.put("\\<Odot>", "â¨€");
        map.put("\\<ointegral>", "âˆ®");
        map.put("\\<omega>", "Ï‰");
        map.put("\\<Omega>", "Î©");
        map.put("\\<ominus>", "âŠ–");
        map.put("\\<one>", "ğŸ­");
        map.put("\\<onehalf>", "Â½");
        map.put("\\<onequarter>", "Â¼");
        map.put("\\<o>", "ğ—ˆ");
        map.put("\\<O>", "ğ’ª");
        map.put("\\<oo>", "ğ”¬");
        map.put("\\<OO>", "ğ”’");
        map.put("\\<open>", "â€¹");
        map.put("\\<oplus>", "âŠ•");
        map.put("\\<Oplus>", "â¨");
        map.put("\\<or>", "âˆ¨");
        map.put("\\<Or>", "â‹");
        map.put("\\<ordfeminine>", "Âª");
        map.put("\\<ordmasculine>", "Âº");
        map.put("\\<oslash>", "âŠ˜");
        map.put("\\<otimes>", "âŠ—");
        map.put("\\<Otimes>", "â¨‚");
        map.put("\\<paragraph>", "Â¶");
        map.put("\\<parallel>", "âˆ¥");
        map.put("\\<Parallel>", "â€–");
        map.put("\\<partial>", "âˆ‚");
        map.put("\\<phi>", "Ï†");
        map.put("\\<Phi>", "Î¦");
        map.put("\\<pi>", "Ï€");
        map.put("\\<Pi>", "Î ");
        map.put("\\<plusminus>", "Â±");
        map.put("\\<pounds>", "Â£");
        map.put("\\<p>", "ğ—‰");
        map.put("\\<P>", "ğ’«");
        map.put("\\<pp>", "ğ”­");
        map.put("\\<PP>", "ğ”“");
        map.put("\\<prec>", "â‰º");
        map.put("\\<preceq>", "â‰¼");
        map.put("\\<Prod>", "âˆ");
        map.put("\\<propto>", "âˆ");
        map.put("\\<psi>", "Ïˆ");
        map.put("\\<Psi>", "Î¨");
        map.put("\\<q>", "ğ—Š");
        map.put("\\<Q>", "ğ’¬");
        map.put("\\<qq>", "ğ”®");
        map.put("\\<QQ>", "ğ””");
        map.put("\\<questiondown>", "Â¿");
        map.put("\\<rangle>", "âŸ©");
        map.put("\\<rat>", "â„š");
        map.put("\\<rblot>", "â¦Š");
        map.put("\\<rbrace>", "â¦„");
        map.put("\\<rbrakk>", "âŸ§");
        map.put("\\<rceil>", "âŒ‰");
        map.put("\\<real>", "â„");
        map.put("\\<registered>", "Â®");
        map.put("\\<restriction>", "â†¾");
        map.put("\\<rfloor>", "âŒ‹");
        map.put("\\<rhd>", "âŠ³");
        map.put("\\<rho>", "Ï");
        map.put("\\<rightarrow>", "â†’");
        map.put("\\<Rightarrow>", "â‡’");
        map.put("\\<rightharpoondown>", "â‡");
        map.put("\\<rightharpoonup>", "â‡€");
        map.put("\\<rightleftharpoons>", "â‡Œ");
        map.put("\\<rparr>", "â¦ˆ");
        map.put("\\<r>", "ğ—‹");
        map.put("\\<R>", "â„›");
        map.put("\\<rrangle>", "âŸ«");
        map.put("\\<Rrightarrow>", "â‡›");
        map.put("\\<rr>", "ğ”¯");
        map.put("\\<RR>", "â„œ");
        map.put("\\<section>", "Â§");
        map.put("\\<setminus>", "âˆ–");
        map.put("\\<seven>", "ğŸ³");
        map.put("\\<sharp>", "â™¯");
        map.put("\\<sigma>", "Ïƒ");
        map.put("\\<Sigma>", "Î£");
        map.put("\\<sim>", "âˆ¼");
        map.put("\\<simeq>", "â‰ƒ");
        map.put("\\<six>", "ğŸ²");
        map.put("\\<^smallskip>", "â”ˆ");
        map.put("\\<smile>", "âŒ£");
        map.put("\\<some>", "Ïµ");
        map.put("\\<spadesuit>", "â™ ");
        map.put("\\<sqdot>", "Â·");
        map.put("\\<sqinter>", "âŠ“");
        map.put("\\<Sqinter>", "â¨…");
        map.put("\\<sqsubset>", "âŠ");
        map.put("\\<sqsubseteq>", "âŠ‘");
        map.put("\\<sqsupset>", "âŠ");
        map.put("\\<sqsupseteq>", "âŠ’");
        map.put("\\<squnion>", "âŠ”");
        map.put("\\<Squnion>", "â¨†");
        map.put("\\<s>", "ğ—Œ");
        map.put("\\<S>", "ğ’®");
        map.put("\\<sslash>", "â«½");
        map.put("\\<ss>", "ğ”°");
        map.put("\\<SS>", "ğ”–");
        map.put("\\<star>", "â‹†");
        map.put("\\<stileturn>", "âŠ£");
        map.put("\\<^sub>", "â‡©");
        map.put("\\<subset>", "âŠ‚");
        map.put("\\<subseteq>", "âŠ†");
        map.put("\\<succ>", "â‰»");
        map.put("\\<succeq>", "â‰½");
        map.put("\\<Sum>", "âˆ‘");
        map.put("\\<^sup>", "â‡§");
        map.put("\\<supset>", "âŠƒ");
        map.put("\\<supseteq>", "âŠ‡");
        map.put("\\<surd>", "âˆš");
        map.put("\\<tau>", "Ï„");
        map.put("\\<then>", "âª¢");
        map.put("\\<^theory_text>", "â¬š");
        map.put("\\<theta>", "Î¸");
        map.put("\\<Theta>", "Î˜");
        map.put("\\<three>", "ğŸ¯");
        map.put("\\<threequarters>", "Â¾");
        map.put("\\<times>", "Ã—");
        map.put("\\<top>", "âŠ¤");
        map.put("\\<triangle>", "â–³");
        map.put("\\<triangleleft>", "â—ƒ");
        map.put("\\<triangleq>", "â‰œ");
        map.put("\\<triangleright>", "â–¹");
        map.put("\\<t>", "ğ—");
        map.put("\\<T>", "ğ’¯");
        map.put("\\<tt>", "ğ”±");
        map.put("\\<TT>", "ğ”—");
        map.put("\\<tturnstile>", "âŠ©");
        map.put("\\<TTurnstile>", "âŠ«");
        map.put("\\<turnstile>", "âŠ¢");
        map.put("\\<Turnstile>", "âŠ¨");
        map.put("\\<two>", "ğŸ®");
        map.put("\\<^undefined>", "â–");
        map.put("\\<union>", "âˆª");
        map.put("\\<Union>", "â‹ƒ");
        map.put("\\<unlhd>", "âŠ´");
        map.put("\\<unrhd>", "âŠµ");
        map.put("\\<up>", "â†‘");
        map.put("\\<Up>", "â‡‘");
        map.put("\\<updown>", "â†•");
        map.put("\\<Updown>", "â‡•");
        map.put("\\<upharpoonleft>", "â†¿");
        map.put("\\<uplus>", "âŠ");
        map.put("\\<Uplus>", "â¨„");
        map.put("\\<upsilon>", "Ï…");
        map.put("\\<Upsilon>", "Î¥");
        map.put("\\<^url>", "ğŸŒ");
        map.put("\\<u>", "ğ—");
        map.put("\\<U>", "ğ’°");
        map.put("\\<uu>", "ğ”²");
        map.put("\\<UU>", "ğ”˜");
        map.put("\\<^verbatim>", "â–©");
        map.put("\\<v>", "ğ—");
        map.put("\\<V>", "ğ’±");
        map.put("\\<vv>", "ğ”³");
        map.put("\\<VV>", "ğ”™");
        map.put("\\<wp>", "â„˜");
        map.put("\\<wrong>", "â‰€");
        map.put("\\<w>", "ğ—");
        map.put("\\<W>", "ğ’²");
        map.put("\\<ww>", "ğ”´");
        map.put("\\<WW>", "ğ”š");
        map.put("\\<xi>", "Î¾");
        map.put("\\<Xi>", "Î");
        map.put("\\<x>", "ğ—‘");
        map.put("\\<X>", "ğ’³");
        map.put("\\<xx>", "ğ”µ");
        map.put("\\<XX>", "ğ”›");
        map.put("\\<yen>", "Â¥");
        map.put("\\<y>", "ğ—’");
        map.put("\\<Y>", "ğ’´");
        map.put("\\<yy>", "ğ”¶");
        map.put("\\<YY>", "ğ”œ");
        map.put("\\<Zbij>", "â¤–");
        map.put("\\<Zcat>", "â€");
        map.put("\\<Zcomp>", "â¨¾");
        map.put("\\<Zdres>", "â—");
        map.put("\\<zero>", "ğŸ¬");
        map.put("\\<zeta>", "Î¶");
        map.put("\\<Zffun>", "â‡»");
        map.put("\\<Zfinj>", "â¤•");
        map.put("\\<Zhide>", "â§¹");
        map.put("\\<Zinbag>", "â‹¿");
        map.put("\\<Zinj>", "â†£");
        map.put("\\<Zndres>", "â©¤");
        map.put("\\<Znrres>", "â©¥");
        map.put("\\<Zpfun>", "â‡¸");
        map.put("\\<Zpinj>", "â¤”");
        map.put("\\<Zprime>", "â€²");
        map.put("\\<Zproject>", "â¨¡");
        map.put("\\<Zpsurj>", "â¤€");
        map.put("\\<Zrres>", "â–·");
        map.put("\\<Zsemi>", "â¨Ÿ");
        map.put("\\<Zspot>", "â¦");
        map.put("\\<Zsurj>", "â† ");
        map.put("\\<Ztypecolon>", "â¦‚");
        map.put("\\<z>", "ğ—“");
        map.put("\\<Z>", "ğ’µ");
        map.put("\\<zz>", "ğ”·");
        map.put("\\<ZZ>", "â„¨");

        return map;
    }

    public static StringBuffer xsymbolToUnicodeBuffer(String text) {
        // conversion from xsymbols to unicode won't grow the array, so shouldn't
        // see a realloc
        StringBuffer unicodeBuf = new StringBuffer(text.length());

        Matcher m = xsymbolPat.matcher(text);

        while (m.find()) {
            String symbol = m.group();

            String unicode = symbolMap.get(symbol);
            if (unicode != null) {
                m.appendReplacement(unicodeBuf, unicode);
            } else {
                System.out.println("Warning: unknown xsymbol " + symbol);
                m.appendReplacement(unicodeBuf, symbol);
            }
        }
        m.appendTail(unicodeBuf);

        return unicodeBuf;
    }


    public static String[] xsymbolToUnicodeLines(String text) {
        String[] lines = xsymbolToUnicodeBuffer(text).toString().split("\\R");
        return lines;
    }

}

